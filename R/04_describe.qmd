---
title: "04_describe"
format: html
---

## Load Libraries

```{r}
#| message: false
library(tidyverse)
```

## Load Data

load the data as a variable to use in descriptive graphs

```{r}
#| message: false
augment_data <- read_tsv("/net/pupil1/home/people/s253689/projects/group_12_project/data/03_dat_aug.tsv")
```

## Descriptive Graphs

### Distribution of age groups and race

```{r}
df_plot <- augment_data |>
  mutate(age_group = cut(age,
    breaks = seq(0, 100, by = 10),
    labels = paste(seq(0, 90, 10), seq(9, 99, 10), sep = "-"))) |>
  filter(!is.na(age_group)) |>
  count(age_group, race)

ggplot(df_plot, aes(x = age_group, y = n, fill = race)) +
  geom_col(position = "stack") +
  theme_minimal()
```

### Distribution of hormones in different patients

```{r}
df_plot <- augment_data |>
  filter(!is.na(receptor_group)) |>
  count(receptor_group)

ggplot(df_plot, aes(x = receptor_group, y = n, fill = receptor_group)) +
  geom_col() +
  theme_minimal() + 
  theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5))
```

### Distribution of successful or unsuccessful treatment

```{r}
df_plot <- augment_data |>
  filter(!is.na(response)) |>
  count(response)

ggplot(df_plot, aes(x = response, y = n, fill = response)) +
  geom_col() +
  theme_minimal()
```
