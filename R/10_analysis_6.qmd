---
title: "10_analysis_6"
format: 
  html:
    self-contained: true
editor: visual
---

## Loading Libraries

```{r}
#| message: false
library("here")
library("tidyverse")
```

## Reading the Data

```{r}
#| message: false
data_path <- "data/03_dat_aug.tsv"       
dataset <- read_tsv(file = here(data_path))
```

## Data Wrangling

```{r}
dataset <- dataset |>   
  mutate(     
    # making response into factor -> needed for coloring in graphs     
    response = factor(
      response,
      levels = c("RD", "pCR"),
      exclude = NULL))
```

## Plotting

### HER2 Status vs Treatment Outcome

```{r}
her2_vs_outcome <- ggplot(
  dataset, 
  aes(
    x = her2_status,
    fill = response)) +
  geom_bar(stat = "count",
           position = "stack") +
  scale_fill_manual(
    values = c("RD" = "darkred", 
               "pCR" = "#32CD32")) +
  labs(
    title = "HER2 Status vs Treatment Outcome",
    x = "HER2 Status", 
    y = "Amount", 
    fill = "Response") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45,
                                   hjust = 1),
        plot.title = element_text(hjust = 0.5))

her2_vs_outcome
```
